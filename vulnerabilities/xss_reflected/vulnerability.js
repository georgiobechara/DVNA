'use strict';

var express = require('express');
var bodyParser = require('body-parser'); 
var dvna = express();

dvna.get('/', function(req, res){ 
  var form = '' +
  '<form method="POST" action="/evaluate">' +
  '<input type="text" name="f" placeholder="" />' + 
  '<input type="submit" value="Evaluate" />' + 
  '</form>';
  res.send(form);
});

dvna.use(bodyParser.urlencoded({extended: false}));

dvna.post('/evaluate', function (req, res) { 
  var result;
  eval('result = ' + req.body.f); // <-- supplied data derived from a parameter value is evaluated here.
  res.send('The result is: ' + result); 
});

// TODO: There has to be a better way to expose vulnerabilities instead of using individual ports but this is what
// we have working right now.

dvna.listen(3001);

module.exports = {
  title: 'Reflected XSS',
  server: dvna
}